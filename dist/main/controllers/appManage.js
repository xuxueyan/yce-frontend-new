define(function(){return function($scope,$http,$rootScope,atomicNotifyService){var e={orgId:localStorage.orgId,userId:localStorage.userId};$scope.complete=0,$scope.loadAppManageList=function(){var a=yce.api.apply.applymentList($http,e);utils.responseHandler(a,function(e){0==e.code&&($scope.appManageList=JSON.parse(e.data),$scope.complete++)})},$scope.loadAppManageList(),$scope.toUpdate=function(e,a,t){$rootScope.window.update=!0,$scope.updateConfig={id:"update",title:"升级"};var o=a.deploy.spec.template.spec.containers[0].image.substring(0,a.deploy.spec.template.spec.containers[0].image.lastIndexOf(":"));$scope.upDateData={dcIdList:[],strategy:{image:"img.reg.3g:15000/2048:latest"},appName:a.deploy.metadata.name,comments:"",orgId:localStorage.orgId,userId:localStorage.userId,sessionId:localStorage.sessionId,dcId:Number(t)},$scope.upDateData.dcIdList.push(t),$scope.dcName=e,$scope.selectImage=function(e){$scope.window.select=!1,$scope.image=e;var a=e.substring(0,e.lastIndexOf(":"));a!=o?$scope.errorPrompt=!0:$scope.errorPrompt=!1},$scope.updateSubmit=function(){var e=yce.api.apply.update($http,$scope.upDateData);utils.responseHandler(e,function(e){0==e.code?($rootScope.window.update=!1,$scope.loadAppManageList(),atomicNotifyService.success(e.message,2e3)):atomicNotifyService.error(e.message,2e3)})}},$scope.getImageList=function(){$scope.window.select=!0,$scope.imgSelectConfig={id:"select",title:"镜像"};var e=yce.api.image.imageList($http);utils.responseHandler(e,function(e){0==e.code&&($scope.imageList=JSON.parse(e.data).images)})},$scope.toCapacity=function(e,a){$scope.window.capacity=!0,$scope.capacityConfig={id:"capacity",title:"扩容"},$scope.capacityData={newSize:a.deploy.spec.replicas,dcIdList:[],userId:Number(localStorage.userId),comments:"",appName:a.deploy.metadata.name,imageName:a.deploy.spec.template.spec.containers[0].image,orgId:localStorage.orgId,sessionId:localStorage.sessionId,dcId:e},$scope.capacityData.dcIdList.push(e),$scope.capacityData.comments="scale to "+$scope.capacityData.newSize+" instances"},$scope.capacitySubmit=function(){var e=yce.api.apply.capacity($http,$scope.capacityData);utils.responseHandler(e,function(e){0==e.code?($scope.loadAppManageList(),$scope.window.capacity=!1,atomicNotifyService.success(e.message,2e3)):atomicNotifyService.error(e.message,2e3)})},$scope.slider={value:1,options:{ceil:10,floor:1,showSelectionBar:!0,showTicks:!0,getTickColor:function(e){return"#d8e0f3"}}},$scope.toApplyDelete=function(e,a){$scope.window.applyDelete=!0,$scope.applyDeleteConfig={id:"applyDelete",title:"删除"};var t={userId:localStorage.userId,dcIdList:[],sessionId:localStorage.sessionId,comments:"delete app: "+a.deploy.metadata.name,orgId:localStorage.orgId,appName:a.deploy.metadata.name};t.dcIdList.push(e),$scope.applyDeleteSubmit=function(){var e=yce.api.apply.applyDelete($http,t);utils.responseHandler(e,function(e){0==e.code?($scope.loadAppManageList(),$scope.window.applyDelete=!1,atomicNotifyService.success(e.message,2e3)):atomicNotifyService.error(e.message,2e3)})}},$scope.applyRollback=function(){console.log(123),$scope.window.applyRollback=!0,$scope.applyRollbackConfig={id:"applyRollback",title:"回滚"}}}});